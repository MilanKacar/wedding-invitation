<!DOCTYPE html>
<html lang="sr">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Anja &amp; Milan | Pozivnica</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
    <link
      href="https://fonts.googleapis.com/css?family=Great+Vibes|Montserrat:400,700&amp;display=swap"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Tangerine:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* Root variables for consistent theming */
      :root {
        --primary-color: #295f48;
        --accent-color: #204c39;
        --bg-color: #eeeeee;
        --text-color: #18392b;
        --secondary-color: #204c39;
        --gradient1: linear-gradient(
          135deg,
          #eeeeee 0%,
          #295f48 50%,
          #204c39 100%
        );
        --gradient2: linear-gradient(120deg, #295f48 0%, #18392b 100%);
      }

      /* Basic reset and body styling */
      html,
      body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      body {
        min-height: 100vh;
        font-family: 'Roboto', sans-serif;
        color: var(--text-color);
        overflow-x: hidden; /* Prevent horizontal scroll */
      }

      /* Responsive adjustments for countdown on small screens */
      @media (max-width: 500px) {
        .countdown {
          flex-direction: column;
          gap: 0px;
          align-items: center;
        }
        .countdown-item {
          min-width: 0;
          width: 90vw;
          max-width: 320px;
          padding: 14px 0;
          font-size: 1em;
        }
      }

      /* Hero section styling */
      .hero {
        text-align: center;
        padding: 80px 20px 60px 20px;
        position: relative;
        overflow: hidden;
        height: 100vh; /* Full viewport height */
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
      .hero::before {
        content: '';
        position: absolute;
        left: -100px;
        top: -100px;
        width: 300px;
        height: 300px;
        background: transparent;
        z-index: 0;
      }
      .hero-content {
        position: relative;
        z-index: 1;
      }
      .hero h1 {
        font-family: 'Tangerine', cursive;
        font-size: 3.5em;
        color: var(--accent-color);
        margin-bottom: 0.2em;
        letter-spacing: 2px;
        text-shadow: 0 2px 12px #eeeeeecc;
      }
      .hero h2 {
        font-size: 1.5em;
        font-weight: 400;
        margin-bottom: 1.5em;
        color: var(--primary-color);
        letter-spacing: 1px;
      }
      .hero .date {
        font-size: 1.2em;
        color: var(--accent-color);
        background: #ffffffcc; /* Slightly transparent white */
        display: inline-flex;
        align-items: center;
        padding: 12px 22px;
        border-radius: 28px;
        box-shadow: 0 2px 12px #295f4822;
        margin-bottom: 1.5em;
        font-weight: 700;
        letter-spacing: 1px;
      }
      .hero .scroll-down {
        margin-top: 40px;
        font-size: 2em;
        color: var(--primary-color);
        animation: bounce 2s infinite;
        text-shadow: 0 2px 8px #204c3988;
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100%;
      }
      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(15px);
        }
      }

      /* General section styling */
      .section {
        max-width: 900px;
        margin: 60px auto;
        padding: 40px 20px;
        background: rgba(255, 255, 255, 0.75); /* Semi-transparent background */
        backdrop-filter: blur(3px); /* Blur effect */
        border-radius: 18px;
        box-shadow: 0 8px 32px #295f4818;
        position: relative;
      }
      .section-title {
        font-family: 'Tangerine', cursive;
        font-size: 3em;
        color: var(--primary-color);
        text-align: center;
        margin-bottom: 0.5em;
        letter-spacing: 1px;
      }
      .divider {
        width: 80px;
        height: 3px;
        background: linear-gradient(
          90deg,
          var(--primary-color),
          var(--secondary-color)
        );
        margin: 0 auto 2em auto;
        border-radius: 2px;
      }

      /* Countdown section */
      .countdown {
        display: flex;
        justify-content: center;
        gap: 30px;
        margin: 40px 0;
      }
      .countdown-item {
        text-align: center;
        background: var(--primary-color);
        color: var(--bg-color);
        padding: 20px 30px;
        border-radius: 12px;
        max-width: 200px;
        min-width: 100px;
        box-shadow: 0 2px 12px #295f4833;
        font-size: 1.3em;
      }
      .countdown-number {
        font-size: 2.2em;
        font-weight: bold;
        margin-bottom: 0.2em;
        letter-spacing: 1px;
      }

      /* Timeline for schedule */
      .timeline {
        position: relative;
        max-width: 900px;
        margin: 20px auto 0 auto;
        padding: 0 20px;
      }
      .timeline::before {
        content: '';
        position: absolute;
        top: 0;
        bottom: 0;
        left: 50%; /* Center the line */
        width: 6px;
        background: var(--primary-color);
        transform: translateX(-50%);
        z-index: 0;
      }
      .timeline-item {
        padding: 20px 20px;
        position: relative;
        width: 50%; /* Half width for alternating sides */
        box-sizing: border-box;
        z-index: 1;
      }
      .timeline-item:nth-child(odd) {
        left: 0;
        text-align: right;
      }
      .timeline-item:nth-child(even) {
        left: 50%;
        text-align: left;
      }
      .timeline-content {
        padding: 24px;
        background: #eeeeee;
        border-radius: 12px;
        box-shadow: 0px 0px 12px #295f4818;
        position: relative;
        display: inline-block; /* Shrink to content */
        min-width: 200px;
        transition: transform 0.3s;
      }
      .timeline-item:nth-child(odd) .timeline-content {
        padding: 24px 72px 24px 28px; /* Padding for icon on right */
        margin-right: 60px;
      }
      .timeline-item:nth-child(even) .timeline-content {
        padding: 24px 28px 24px 72px; /* Padding for icon on left */
        margin-left: 60px;
      }
      .timeline-content:hover {
        transform: scale(1.04) translateY(-4px);
        box-shadow: 0 12px 32px #295f4833;
      }
      .timeline-icon {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        width: 48px;
        height: 48px;
        background: var(--primary-color);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #eeeeee;
        font-size: 1.7em;
        box-shadow: 0 2px 12px #295f4833;
        z-index: 2;
      }
      .timeline-item:nth-child(odd) .timeline-icon {
        right: -4px; /* Position icon to the right of the line */
      }
      .timeline-item:nth-child(even) .timeline-icon {
        left: -4px; /* Position icon to the left of the line */
      }
      .timeline-content h3 {
        margin: 0 0 0 0;
        color: var(--accent-color);
        font-size: 1.3em;
        font-weight: 700;
        letter-spacing: 1px;
      }
      .timeline-content p {
        margin: 0;
        color: #18392b;
        font-size: 1.05em;
      }

      /* Photo gallery (if you add images later) */
      .gallery {
        display: flex;
        flex-wrap: wrap;
        gap: 18px;
        justify-content: center;
        margin: 40px 0 0 0;
      }
      .photo-frame {
        position: relative;
        width: 220px;
        height: 300px;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 4px 18px #295f4822;
        background: #eeeeee;
        transition: transform 0.3s;
      }
      .photo-frame img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
        transition: filter 0.3s;
      }
      .photo-frame:hover {
        transform: scale(1.04) rotate(-1deg);
        box-shadow: 0 8px 32px #295f4833;
      }
      .photo-frame::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          45deg,
          rgba(41, 95, 72, 0.18) 0%,
          rgba(238, 238, 238, 0) 100%
        );
        opacity: 0;
        transition: opacity 0.3s;
      }
      .photo-frame:hover::after {
        opacity: 1;
      }

      /* Footer styling */
      .footer {
        text-align: center;
        padding: 18px 10px 18px 10px;
        color: #295f48;
        font-size: 0.8em;
        background: #eeeeee;
        margin-top: 60px;
        letter-spacing: 1px;
      }

      /* RSVP section styling */
      .rsvp-section {
        text-align: center;
        margin: 60px auto 0 auto;
        max-width: 900px;
        padding: 40px 20px;
        background: #eeeeee;
        border-radius: 18px;
        box-shadow: 0 8px 32px #295f4818;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      .rsvp-title {
        font-family: 'Tangerine', sans-serif;
        font-size: 2.5em;
        color: var(--primary-color);
        margin-bottom: 0.5em;
      }
      .rsvp-phones {
        font-size: 1em;
        color: var(--accent-color);
        margin-top: 1.5em;
        background: #eeeeee;
        display: inline-block;
        padding: 18px 32px;
        border-radius: 12px;
        box-shadow: 0 2px 12px #295f4822;
        font-weight: 600;
        letter-spacing: 1px;
        text-align: center;
      }

      /* Mobile responsiveness for timeline and sections */
      @media (max-width: 600px) {
        .timeline {
          padding: 0 10px;
        }
        .timeline::before {
          left: 24px; /* Move timeline line to the left */
          transform: translateX(0);
        }
        .timeline-item {
          width: 100% !important; /* Full width for items */
          left: 0 !important;
          text-align: left !important;
          padding-left: 60px; /* Space for the line and icon */
        }
        .timeline-content {
          margin: 0 auto !important;
          padding-left: 28px !important; /* Adjust padding for icon on left */
          padding-right: 28px !important;
        }
        .timeline-item:nth-child(odd) .timeline-icon,
        .timeline-item:nth-child(even) .timeline-icon {
          left: -4px !important; /* Position icon relative to the item */
          right: auto !important;
        }
        .section {
          padding: 24px 4vw;
        }
        .gallery {
          flex-direction: column;
          align-items: center;
        }
        .photo-frame {
          width: 90vw;
          max-width: 320px;
          height: 220px;
        }
        .rsvp-section {
          padding: 24px 4vw;
        }
      }

      /* Animation for the "love" word */
      @keyframes pulseLove {
        0% {
          transform: scale(1);
          color: var(--text-color);
          text-shadow: none;
        }
        50% {
          transform: scale(1.1) rotate(-2deg);
          color: var(--text-color);
          text-shadow: 1px 1px 8px rgba(2, 2, 2, 0.6);
        }
        100% {
          transform: scale(1);
          color: var(--text-color);
          text-shadow: none;
        }
      }
      .love-word {
        display: inline-block;
        animation: pulseLove 2s ease-in-out infinite;
      }

      /* Language switcher button and popup */
      .lang-display {
        position: fixed;
        top: 20px;
        right: 10px;
        z-index: 9999;
        background: transparent;
        border: none;
        color: var(--primary-color);
        padding: 8px 20px;
        font-weight: bold;
        font-size: 1.1em;
        cursor: pointer;
      }
      .lang-popup {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9998;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.4s ease;
      }
      .lang-popup.show {
        opacity: 1;
        pointer-events: all;
      }
      .lang-options {
        display: flex;
        flex-direction: column;
        gap: 20px;
        background: rgba(255, 255, 255, 0.8);
        padding: 50px;
        border-radius: 16px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
      }
      .lang-option {
        font-size: 1.2em;
        font-weight: bold;
        background: transparent;
        color: var(--primary-color);
        border: none;
        padding: 12px 20px;
        border-radius: 10px;
        cursor: pointer;
        transition: background 0.3s ease, transform 0.3s ease;
      }
      .lang-option:hover {
        background: #18392b;
        transform: scale(1.05);
      }

      /* Fade-in animation for translatable elements */
      .fade-translate {
        opacity: 0;
        transform: translateY(-10px);
        transition: opacity 0.6s ease, transform 0.6s ease;
      }
      .fade-translate.show {
        opacity: 1;
        transform: translateY(0);
      }
    </style>
  </head>
  <body>
    <!-- Language Switcher Button -->
    <div class="lang-display" onclick="openLanguagePopup()" id="langCurrent">
      SR
    </div>

    <!-- Language Selection Popup -->
    <div class="lang-popup" id="langPopup" onclick="closeLanguagePopup(event)">
      <div class="lang-options" onclick="event.stopPropagation()">
        <button class="lang-option" onclick="chooseLanguage('sr')">SR</button>
        <button class="lang-option" onclick="chooseLanguage('en')">EN</button>
      </div>
    </div>

    <!-- Background Video -->
    <video
      autoplay=""
      loop=""
      muted=""
      playsinline=""
      poster=""
      preload="auto"
      style="
        position: fixed;
        top: 0;
        left: 0;
        width: 105vw; /* Slightly larger to cover edges */
        height: 120vh; /* Slightly larger to cover edges */
        object-fit: cover;
        opacity: 0.7;
        filter: brightness(0.8) grayscale(0.1);
        z-index: -2;
        pointer-events: none;
        overflow: hidden;
      "
    >
      <source src="./wedding-vid.mp4" type="video/mp4" />
      Your browser does not support the video tag.
    </video>

    <!-- Background Gradient Overlay -->
    <div
      style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: linear-gradient(135deg, #eeeeee99 60%, #295f4899 100%);
        pointer-events: none;
        z-index: -1;
        max-height: 100vh;
        overflow: hidden;
      "
    ></div>

    <!-- Hero Section -->
    <div class="hero" data-aos="fade-down">
      <div class="hero-content">
        <h1>Anja &amp; Milan</h1>
        <h2>are getting married!</h2>
        <div class="date">
          <i
            class="fa-solid fa-calendar-heart"
            style="margin-right: 10px; font-size: 1.2em"
          ></i
          ><span data-i18n="date">13. Septembar 2025 </span>
        </div>
        <div style="text-align: center; margin-top: 20px">
          <a
            href="https://milankacar.github.io/wedding-invitation/milan-anja-wedding.ics"
            style="
              margin-left: 0px;
              background: var(--primary-color);
              color: white;
              padding: 8px 16px;
              border-radius: 24px;
              font-size: 0.9em;
              font-weight: 600;
              text-decoration: none;
              display: inline-block;
              box-shadow: 0 2px 8px #295f4822;
            "
          >
            <i class="fa-solid fa-calendar-plus" style="margin-right: 6px"></i
            ><span data-i18n="saveToCalendar">Sačuvaj u kalendar</span>
          </a>
        </div>
        <div class="scroll-down">
          <i class="fa-solid fa-chevron-down"></i>
        </div>
      </div>
    </div>

    <!-- Invitation Section -->
    <div class="section" data-aos="fade-up">
      <div class="section-title" data-i18n="invited">Pozivamo</div>
      <div class="divider"></div>
      <p
        style="
          text-align: center;
          font-size: 1.2em;
          max-width: 600px;
          margin: 0 auto;
          font-family: Roboto, sans-serif;
        "
      >
        <span data-i18n="loveLine"> Slavićemo</span>
        <span class="love-word" data-i18n="love">ljubav</span>
        <br />
        <span data-i18n="joinUs">i voljeli bismo da budete dio nje!</span>
      </p>
      <!-- Countdown Timer -->
      <div class="countdown" data-aos="zoom-in">
        <div class="countdown-item">
          <div class="countdown-number" id="days">00</div>
          <div data-i18n="days">Dana</div>
        </div>
        <div class="countdown-item">
          <div class="countdown-number" id="hours">00</div>
          <div data-i18n="hours">Sati</div>
        </div>
        <div class="countdown-item">
          <div class="countdown-number" id="minutes">00</div>
          <div data-i18n="minutes">Minuta</div>
        </div>
        <div class="countdown-item">
          <div class="countdown-number" id="seconds">00</div>
          <div data-i18n="seconds">Sekundi</div>
        </div>
      </div>
    </div>

    <!-- Schedule Section -->
    <div
      class="section"
      style="overflow: hidden; margin: 60px auto; padding: 40px 20px"
      data-aos="fade-down"
    >
      <div class="section-title" data-i18n="schedule">Raspored</div>
      <div class="divider"></div>
      <div class="timeline">
        <div class="timeline-item" data-aos="fade-right">
          <div class="timeline-content">
            <div class="timeline-icon"><i class="fas fa-church"></i></div>
            <h3 data-i18n="ceremony">Crkveno Vjenčanje</h3>
            <p data-i18n="church_location">15:00 - Crkva Sv. Trojice</p>
          </div>
        </div>
        <div class="timeline-item" data-aos="fade-left">
          <div class="timeline-content">
            <div class="timeline-icon"><i class="fas fa-glass-cheers"></i></div>
            <h3>Welcome Drinks</h3>
            <p data-i18n="drinks">16:00 - Skup svatova &amp; vaše prvo piće</p>
          </div>
        </div>
        <div class="timeline-item" data-aos="fade-right">
          <div class="timeline-content">
            <div class="timeline-icon"><i class="fas fa-utensils"></i></div>
            <h3 data-i18n="dinner">Večera</h3>
            <p data-i18n="hungry">Obavezno dođite gladni.</p>
          </div>
        </div>
        <div class="timeline-item" data-aos="fade-left">
          <div class="timeline-content">
            <div class="timeline-icon"><i class="fas fa-music"></i></div>
            <h3>Party &amp; Dancing</h3>
            <p data-i18n="dancing">Zamjerimo ljudima koji sjede!</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Location Section -->
    <div
      class="section"
      data-aos="fade-up"
      style="
        background: #f8fafc;
        border-radius: 22px;
        box-shadow: 0 8px 32px #295f4812;
      "
    >
      <div class="section-title" data-i18n="location">
        Lokacija
        <span
          style="
            display: inline-block;
            vertical-align: middle;
            margin-left: 0.3em;
            color: #204c39;
          "
        >
          <i class="fa-solid fa-location-dot"></i>
        </span>
      </div>
      <div class="divider"></div>
      <div style="text-align: center; margin-bottom: 1.2em">
        <span
          style="
            font-size: 1.25em;
            font-weight: 600;
            color: var(--primary-color);
          "
        >
          <i class="fa-solid fa-map-pin" style="color: #204c39"></i>
          <span style="font-family: 'Roboto', sans-serif"
            >Stara Ada Ostrvo</span
          >
        </span>
        <br />
        <span style="font-size: 1.3em; color: var(--accent-color)" data-i18n="exact_location">
          Banja Luka, Bosnia i Hercegovina
        </span>
        <br />
        <a
          href="https://www.google.com/maps?q=Stara+Ada+Ostrvo,+Banja+Luka,+Bosnia+and+Herzegovina"
          rel="noopener"
          style="
            display: inline-block;
            margin-top: 0.7em;
            background: var(--primary-color);
            color: #fff;
            padding: 10px 28px;
            border-radius: 30px;
            font-size: 1.3em;
            font-weight: 500;
            text-decoration: none;
            box-shadow: 0 2px 12px #295f4822;
            transition: background 0.2s;
          "
          target="_blank"
        >
          <i class="fa-solid fa-map-location-dot"></i> Google Maps
        </a>
      </div>
      <div
        style="
          border-radius: 16px;
          overflow: hidden;
          box-shadow: 0 4px 18px #295f4822;
          max-width: 600px;
          margin: 0 auto;
        "
      >
        <iframe
          allowfullscreen=""
          height="320"
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"
          src="https://www.google.com/maps?q=44.7706174,17.2188071&amp;z=18&amp;output=embed&amp;maptype=satellite"
          style="border: 0; min-width: 200px"
          title="Wedding Location Map"
          width="100%"
        ></iframe>
      </div>
      <div
        style="
          text-align: center;
          margin-top: 1.2em;
          color: #18392b;
          font-size: 1.05em;
        "
      >
        <i class="fa-solid fa-parking"></i>
        <span data-i18n="parking">Slobodan parking je dostupan</span>
      </div>
    </div>

    <!-- RSVP Section -->
    <div class="section rsvp-section" data-aos="fade-up">
      <div class="rsvp-title" data-i18n="rsvp">Potvrdite svoj dolazak</div>
      <div class="divider"></div>
      <div class="rsvp-phones">
        <p data-i18n="confirmBy">
          Molimo vas da potvrdite svoj dolazak do 1. avgusta.
        </p>
        <br />
        <br />
        <i class="fa-solid fa-phone"></i> Milan:
        <a
          href="tel:+4367761437595"
          style="color: inherit; text-decoration: underline"
          >+43 677 61437595</a
        ><br />
        <i class="fa-solid fa-phone"></i> Anja:
        <a
          href="tel:+4367761679671"
          style="color: inherit; text-decoration: underline"
          >+43 677 61679671</a
        >
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">Anja &amp; Milan — 13 Septembar 2025</div>

    <!-- AOS Library Script -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
      AOS.init({ duration: 1000, once: true });

      // Countdown Timer Logic
      const weddingDate = new Date('2025-09-13T14:00:00').getTime(); // Set your wedding date and time
      function updateCountdown() {
        const now = new Date().getTime();
        const distance = weddingDate - now;

        // If the countdown is over, display zeros
        if (distance < 0) {
          document.getElementById('days').innerHTML = '00';
          document.getElementById('hours').innerHTML = '00';
          document.getElementById('minutes').innerHTML = '00';
          document.getElementById('seconds').innerHTML = '00';
          return;
        }

        // Calculate time units
        document.getElementById('days').innerHTML = String(
          Math.floor(distance / (1000 * 60 * 60 * 24))
        ).padStart(2, '0');
        document.getElementById('hours').innerHTML = String(
          Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60))
        ).padStart(2, '0');
        document.getElementById('minutes').innerHTML = String(
          Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60))
        ).padStart(2, '0');
        document.getElementById('seconds').innerHTML = String(
          Math.floor((distance % (1000 * 60)) / 1000)
        ).padStart(2, '0');
      }
      updateCountdown(); // Initial call
      setInterval(updateCountdown, 1000); // Update every second
    </script>

    <!-- Fireworks Canvas and Script -->
    <canvas
      id="fireworks-canvas"
      style="
        position: fixed;
        top: 0;
        left: 0;
        pointer-events: none;
        width: 100vw;
        height: 100vh;
        z-index: 5;
      "
    ></canvas>
    <script>
      const canvas = document.getElementById('fireworks-canvas');
      const ctx = canvas.getContext('2d');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      // Resize canvas on window resize
      window.addEventListener('resize', () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      });

      const royalColors = ['#b49aff', '#ffd700', '#ffffff', '#a9c9ff', '#f0e6ff'];

      // Helper for random integers
      function randomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      // Firework particle constructor
      function Firework(x, y) {
        this.x = x;
        this.y = y;
        this.particles = [];
        for (let i = 0; i < 200; i++) {
          this.particles.push({
            x: x,
            y: y,
            radius: Math.random() * 2.5 + 1,
            color: royalColors[Math.floor(Math.random() * royalColors.length)],
            angle: Math.random() * 2 * Math.PI,
            speed: Math.random() * 7 + 2,
            alpha: 1,
            decay: Math.random() * 0.01 + 0.004,
            twinkle: Math.random() > 0.4, // Add a twinkle effect
          });
        }
      }

      // Update firework particles
      Firework.prototype.update = function () {
        this.particles.forEach((p) => {
          p.x += Math.cos(p.angle) * p.speed;
          p.y += Math.sin(p.angle) * p.speed;
          p.alpha -= p.decay;
        });
      };

      // Draw firework particles
      Firework.prototype.draw = function () {
        this.particles.forEach((p, i) => {
          if (p.alpha > 0) {
            ctx.beginPath();
            ctx.arc(p.x, p.y, p.radius, 0, 2 * Math.PI);
            // Apply twinkling effect to alpha
            const alphaMod = p.twinkle
              ? Math.abs(Math.sin(Date.now() * 0.007 + i))
              : p.alpha;
            ctx.fillStyle = `rgba(${hexToRgb(p.color)},${alphaMod})`;
            ctx.fill();
          }
        });
      };

      // Helper to convert hex color to RGB string
      function hexToRgb(hex) {
        hex = hex.replace('#', '');
        const bigint = parseInt(hex, 16);
        return [(bigint >> 16) & 255, (bigint >> 8) & 255, bigint & 255].join(
          ','
        );
      }

      // Create and animate fireworks
      const fireworks = [];
      for (let i = 0; i < 10; i++) {
        setTimeout(() => {
          fireworks.push(
            new Firework(
              randomInt(80, canvas.width - 80),
              randomInt(100, canvas.height / 2)
            )
          );
        }, i * 250);
      }

      // Animation loop
      function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear canvas
        fireworks.forEach((f) => {
          f.update(); // Update particle positions
          f.draw(); // Draw particles
        });
        requestAnimationFrame(animate); // Loop animation
      }
      animate(); // Start animation
      // Hide fireworks canvas after a few seconds
      setTimeout(() => {
        document.getElementById('fireworks-canvas').style.display = 'none';
      }, 5500);
    </script>

    <!-- Main Application Logic Script -->
    <script>
      // Utility function to get a specific parameter from the URL
      // e.g., getUrlParameter('lang') would return 'en' from ?lang=en
      function getUrlParameter(name) {
        name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
        var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
        var results = regex.exec(location.search);
        return results === null
          ? ''
          : decodeURIComponent(results[1].replace(/\+/g, ' '));
      }

      // Function to get the guest name from the URL
      // It checks for 'name=' parameter first, then the direct query string.
      // It explicitly ignores 'lang=' parameter when parsing the direct query string.
      function getGuestName() {
        const query = window.location.search.substring(1); // Get everything after '?'
        if (!query) return '';

        // Prioritize 'name=' parameter (e.g., ?name=Family%20Jack)
        const nameParam = getUrlParameter('name');
        if (nameParam) {
          return nameParam;
        }

        // If no 'name=' parameter, try to find the guest name as the first non-language part
        const parts = query.split('&');
        let guestName = '';
        for (const part of parts) {
          if (!part.startsWith('lang=')) {
            // Found a part that is not 'lang=', assume it's the guest name
            guestName = decodeURIComponent(part.replace(/\+/g, ' '));
            break; // Take the first one found
          }
        }
        return guestName;
      }

      // Translations object for Serbian and English
      const translations = {
        en: {
          invited: "You're invited",
          loveLine: 'We’ll celebrate',
          love: 'love',
          joinUs: 'and we would love you to be part of it!',
          days: 'Days',
          hours: 'Hours',
          minutes: 'Minutes',
          seconds: 'Seconds',
          church_location: '3pm Church of Holy Trinity',
          schedule: 'Schedule',
          ceremony: 'Church Ceremony',
          drinks: '4pm Guest gathering & your first drink',
          dinner: 'Dinner',
          hungry: 'Be sure to come hungry.',
          dancing: "Don't think about sitting!",
          location: 'Location',
          exact_location: 'Banja Luka, Bosnia and Herzegovina',
          parking: 'Free parking available',
          rsvp: 'Confirm your attendance',
          confirmBy: 'Please confirm your attendance by August 1st.',
          saveToCalendar: 'Save to calendar',
          date: 'September 13th, 2025',
        },
        sr: {
          invited: 'Pozivamo vas',
          loveLine: 'Slavićemo',
          love: 'ljubav',
          joinUs: 'i voljeli bismo da budete dio nje!',
          days: 'Dana',
          hours: 'Sati',
          minutes: 'Minuta',
          seconds: 'Sekundi',
          church_location: '15:00 Crkva Sv. Trojice',
          schedule: 'Raspored',
          ceremony: 'Crkveno Vjenčanje',
          drinks: 'Skup svatova & vaše prvo piće',
          dinner: 'Večera',
          hungry: 'Obavezno dođite gladni.',
          dancing: 'Zamjerimo ljudima koji sjede!',
          location: 'Lokacija',
          exact_location: 'Banja Luka, Bosnia i Hercegovina',
          parking: 'Slobodan parking je dostupan',
          rsvp: 'Potvrdite svoj dolazak',
          confirmBy: 'Molimo vas da potvrdite svoj dolazak do 1. avgusta.',
          saveToCalendar: 'Sačuvaj u kalendar',
          date: '13. Septembar 2025',
        },
      };

      // Function to switch the language of the page content
      function switchLanguage(lang) {
        document.documentElement.lang = lang; // Set HTML lang attribute
        const elements = document.querySelectorAll('[data-i18n]');
        elements.forEach((el) => {
          el.classList.remove('show'); // Start fade-out
          const key = el.getAttribute('data-i18n');
          // Delay text change to allow fade-out effect
          setTimeout(() => {
            el.textContent = translations[lang][key] || el.textContent;
            el.classList.add('show'); // Start fade-in
          }, 200);
        });
      }

      // Function to open the language selection popup
      function openLanguagePopup() {
        const popup = document.getElementById('langPopup');
        popup.classList.add('show');
      }

      // Function to close the language selection popup
      function closeLanguagePopup(event) {
        const popup = document.getElementById('langPopup');
        // Close only if clicking on the overlay, not the options themselves
        if (event.target === popup) {
          popup.classList.remove('show');
        }
      }

      // Function to choose a language and update the display
      function chooseLanguage(lang) {
        const popup = document.getElementById('langPopup');
        popup.classList.remove('show'); // Close popup
        document.getElementById('langCurrent').textContent = lang.toUpperCase(); // Update current language display
        switchLanguage(lang); // Apply translations
      }

      // Event listener for when the entire page has loaded
      window.addEventListener('load', () => {
        // 1. Determine Language from URL or set default
        const urlLang = getUrlParameter('lang');
        if (urlLang && translations[urlLang]) {
          chooseLanguage(urlLang); // Set language from URL
        } else {
          chooseLanguage('sr'); // Default to Serbian if no valid language parameter
        }

        // 2. Display Guest Name (after language is set, for correct "Pozivamo" text)
        const guestName = getGuestName();
        if (guestName) {
          // Find the "Pozivamo" / "You're Invited" section title
          const sections = document.querySelectorAll('.section-title');
          for (const section of sections) {
            // Check both original and translated text for robustness
            if (
              section.textContent.trim() === 'Pozivamo' ||
              section.textContent.trim() === "You're invited"
            ) {
              const nameDiv = document.createElement('div');
              nameDiv.textContent = guestName;
              nameDiv.style.fontFamily = "'Tangerine', cursive"; // Use a nice font
              nameDiv.style.fontSize = '3em'; // Make it prominent
              nameDiv.style.color = 'var(--primary-color)';
              nameDiv.style.marginTop = '0.2em';
              nameDiv.style.marginBottom = '0.5em';
              nameDiv.style.textAlign = 'center';
              section.insertAdjacentElement('afterend', nameDiv); // Insert after the section title
              break; // Stop after finding and inserting
            }
          }
        }

        // Apply initial fade-in animation to all translatable elements
        document.querySelectorAll('[data-i18n]').forEach((el) => {
          el.classList.add('fade-translate', 'show');
        });
      });
    </script>
  </body>
</html>
